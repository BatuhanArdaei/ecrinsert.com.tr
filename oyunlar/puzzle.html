<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>AnÄ±larÄ±mÄ±zÄ± EÅŸleÅŸtir ðŸ§©</title>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

  <style>
    :root {
      --primary: #ff9a9e;
      --secondary: #fad0c4;
      --glass: rgba(255, 255, 255, 0.4);
      --glass-border: rgba(255, 255, 255, 0.6);
      --text: #6b4c4c;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }

    body {
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(135deg, #fdfbfb 0%, #ebedee 100%);
      background: radial-gradient(circle at center, #ffdde1, #ee9ca7);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
      padding-top: 80px; /* MenÃ¼ butonu iÃ§in */
      color: var(--text);
    }

    /* MENÃœ BUTONU */
    .nav-back {
      position: fixed; top: 20px; left: 20px; z-index: 100;
      background: var(--glass); backdrop-filter: blur(10px);
      border: 1px solid var(--glass-border); padding: 10px 20px;
      border-radius: 30px; text-decoration: none; color: #6b4c4c;
      font-weight: 700; font-size: 0.9rem; box-shadow: 0 4px 15px rgba(0,0,0,0.05);
      display: flex; align-items: center; gap: 8px; transition: 0.3s;
    }
    .nav-back:hover { background: white; color: var(--primary); transform: translateY(-2px); }

    /* BAÅžLIK */
    header { text-align: center; margin-bottom: 20px; z-index: 2; }
    h1 { font-size: 2rem; color: #fff; text-shadow: 0 2px 4px rgba(0,0,0,0.1); margin-bottom: 5px; }
    p.subtitle { color: rgba(255,255,255,0.9); font-size: 1rem; }

    /* OYUN ALANI (GRID) */
    .game-grid {
      display: grid;
      grid-template-columns: repeat(4, 1fr); /* 4 SÃ¼tun */
      gap: 10px;
      width: 100%;
      max-width: 450px;
      perspective: 1000px; /* 3D Efekt iÃ§in */
      z-index: 2;
    }

    /* KART YAPISI */
    .card {
      background-color: transparent;
      aspect-ratio: 1 / 1; /* Kare olsun */
      cursor: pointer;
      position: relative;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      text-align: center;
      transition: transform 0.6s;
      transform-style: preserve-3d;
      border-radius: 15px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    /* Kart Ã§evrildiÄŸinde */
    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    /* EÅŸleÅŸen kart */
    .card.matched .card-inner {
      border: 2px solid #fff;
      box-shadow: 0 0 15px #ff9a9e;
    }

    /* Ã–n ve Arka YÃ¼zler */
    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      -webkit-backface-visibility: hidden;
      backface-visibility: hidden;
      border-radius: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    /* Arka YÃ¼z (Desen/Kalp) */
    .card-front {
      background: linear-gradient(45deg, #ff9a9e, #fad0c4);
      color: white;
      font-size: 2rem;
    }

    /* Ã–n YÃ¼z (FotoÄŸraf) */
    .card-back {
      background-color: white;
      transform: rotateY(180deg);
    }

    .card-back img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* BÄ°TÄ°Åž EKRANI */
    #win-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: rgba(0,0,0,0.6); backdrop-filter: blur(10px);
      z-index: 200; display: none;
      flex-direction: column; align-items: center; justify-content: center;
      text-align: center; animation: fadeIn 0.5s;
    }
    .win-card {
      background: white; padding: 40px; border-radius: 30px; width: 90%; max-width: 400px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
    }
    .btn-restart {
      background: var(--primary); color: white; padding: 12px 30px;
      border-radius: 25px; border: none; font-size: 1.1rem; font-weight: bold;
      cursor: pointer; margin-top: 20px; transition: 0.3s;
    }
    .btn-restart:hover { transform: scale(1.05); }

    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

    /* Canvas Arka Plan */
    #bgCanvas { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; pointer-events: none; }

    footer { margin-top: 40px; font-size: 0.8rem; color: rgba(255,255,255,0.8); z-index: 2; text-align: center;}

    @media (max-width: 400px) {
        .game-grid { gap: 8px; }
    }
  </style>
</head>
<body>

  <canvas id="bgCanvas"></canvas>

  <a href="../index.html" class="nav-back"><i class="fa-solid fa-arrow-left"></i> MenÃ¼</a>

  <header>
    <h1>AnÄ± EÅŸleÅŸtirme ðŸ§©</h1>
    <p class="subtitle">FotoÄŸraflarÄ±mÄ±zÄ± bulabilir misin?</p>
  </header>

  <div class="game-grid" id="game-grid">
    <!-- Kartlar JS ile oluÅŸturulacak -->
  </div>

  <!-- KAZANMA EKRANI -->
  <div id="win-overlay">
    <div class="win-card">
      <h1 style="color:#ff6b81; font-size:2.5rem;">Tebrikler! ðŸŽ‰</h1>
      <p style="color:#555; font-size:1.1rem;">BÃ¼tÃ¼n anÄ±larÄ±mÄ±zÄ± birleÅŸtirdin aÅŸkÄ±m! Seni Ã§ok seviyorum. ðŸ’–</p>
      <button class="btn-restart" onclick="restartGame()">Tekrar Oyna ðŸ”„</button>
    </div>
  </div>

  <footer>
    BatuhanArda tarafÄ±ndan DÃ¼nyalar GÃ¼zeli Sevgilisi Ecrin'e hazÄ±rlanmÄ±ÅŸtÄ±r ðŸ’–
  </footer>

  <script>
    /* 
       AYARLAR:
       BurayÄ± senin dosya isimlerine gÃ¶re .jpeg yaptÄ±m.
       Dosyalar 'puzzle_img' klasÃ¶rÃ¼nde olmalÄ±.
    */
    const imageList = [
      '1.jpeg', '2.jpeg', '3.jpeg', '4.jpeg', 
      '5.jpeg', '6.jpeg', '7.jpeg', '8.jpeg'
    ];
    
    // Her resimden iki tane olsun (EÅŸleÅŸtirme iÃ§in)
    let cardsArray = [...imageList, ...imageList];
    
    const grid = document.getElementById('game-grid');
    const winOverlay = document.getElementById('win-overlay');
    
    let firstCard = null;
    let secondCard = null;
    let lockBoard = false; // TÄ±klamayÄ± geÃ§ici kilitleme
    let matchedCount = 0;

    function shuffle(array) {
      return array.sort(() => 0.5 - Math.random());
    }

    function createBoard() {
      grid.innerHTML = '';
      matchedCount = 0;
      firstCard = null; 
      secondCard = null;
      lockBoard = false;
      
      shuffle(cardsArray);

      cardsArray.forEach(imgName => {
        const card = document.createElement('div');
        card.classList.add('card');
        card.dataset.name = imgName;

        const inner = document.createElement('div');
        inner.classList.add('card-inner');

        // Ã–n YÃ¼z (Kalp)
        const front = document.createElement('div');
        front.classList.add('card-front');
        front.innerHTML = '<i class="fa-solid fa-heart"></i>';

        // Arka YÃ¼z (FotoÄŸraf)
        const back = document.createElement('div');
        back.classList.add('card-back');
        const img = document.createElement('img');
        img.src = `puzzle_img/${imgName}`; // Resim yolu
        img.alt = "AnÄ±";
        back.appendChild(img);

        inner.appendChild(front);
        inner.appendChild(back);
        card.appendChild(inner);
        
        card.addEventListener('click', flipCard);
        grid.appendChild(card);
      });
    }

    function flipCard() {
      if (lockBoard) return;
      if (this === firstCard) return; // AynÄ± karta tÄ±klanÄ±rsa

      this.classList.add('flipped');

      if (!firstCard) {
        firstCard = this;
        return;
      }

      secondCard = this;
      checkForMatch();
    }

    function checkForMatch() {
      let isMatch = firstCard.dataset.name === secondCard.dataset.name;

      if (isMatch) {
        disableCards();
      } else {
        unflipCards();
      }
    }

    function disableCards() {
      firstCard.classList.add('matched');
      secondCard.classList.add('matched');
      
      firstCard.removeEventListener('click', flipCard);
      secondCard.removeEventListener('click', flipCard);

      matchedCount += 2;
      
      resetBoard();
      
      if (matchedCount === cardsArray.length) {
        setTimeout(() => {
          winOverlay.style.display = 'flex';
        }, 500);
      }
    }

    function unflipCards() {
      lockBoard = true;
      setTimeout(() => {
        firstCard.classList.remove('flipped');
        secondCard.classList.remove('flipped');
        resetBoard();
      }, 1000);
    }

    function resetBoard() {
      [firstCard, secondCard, lockBoard] = [null, null, false];
    }

    function restartGame() {
      winOverlay.style.display = 'none';
      createBoard();
    }

    // --- BAÅžLANGIÃ‡ ---
    createBoard();

    // --- ARKA PLAN ---
    const cvs = document.getElementById('bgCanvas');
    const ctx = cvs.getContext('2d');
    let parts = [];
    function resize() { cvs.width=window.innerWidth; cvs.height=window.innerHeight; }
    window.addEventListener('resize', resize); resize();

    class P {
        constructor() {
            this.x = Math.random()*cvs.width; 
            this.y = Math.random()*cvs.height;
            this.v = Math.random()*0.5+0.2;
            this.r = Math.random()*2+1;
        }
        up(){ this.y-=this.v; if(this.y<0) this.y=cvs.height; }
        dr(){ ctx.fillStyle='rgba(255,255,255,0.4)'; ctx.beginPath(); ctx.arc(this.x,this.y,this.r,0,Math.PI*2); ctx.fill(); }
    }
    for(let i=0; i<20; i++) parts.push(new P());
    
    function loop(){
        ctx.clearRect(0,0,cvs.width,cvs.height);
        parts.forEach(p=>{ p.up(); p.dr(); });
        requestAnimationFrame(loop);
    }
    loop();

  </script>
</body>
</html>